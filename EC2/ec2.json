{
    "Resources": {
		"SourceSG": {
		"Type": "AWS::EC2::SecurityGroup",
		"Properties": {
			"VpcId" : "vpc-3fb94654",
			"GroupDescription": "Sample source security group"
			}
		},
		"TargetSG": {
		"Type": "AWS::EC2::SecurityGroup",
		"Properties": {
			"VpcId" : "vpc-3fb94654",
			"GroupDescription": "Sample target security group"
			}
		},
		"OutboundRule": {
		"Type": "AWS::EC2::SecurityGroupEgress",
		"Properties":{
			"IpProtocol": "tcp",
			"FromPort": 0,
			"ToPort": 65535,
			"DestinationSecurityGroupId": {
			"Fn::GetAtt": [
			"TargetSG",
			"GroupId"
			]
				},
		"GroupId": {
        "Fn::GetAtt": [
            "SourceSG",
            "GroupId"
				]
				}
			}
		},
		"InboundRule": {
		"Type": "AWS::EC2::SecurityGroupIngress",
		"Properties":{
			"IpProtocol": "tcp",
			"FromPort": 0,
			"ToPort": 65535,
			"SourceSecurityGroupId": {
			 "Fn::GetAtt": [
				"SourceSG",
				"GroupId"
				]
				},
		"GroupId": {
        "Fn::GetAtt": [
            "TargetSG",
            "GroupId"
				]
				}
			}
		},

        "CreateInstance": {
            "Type": "AWS::EC2::Instance",
            "Properties": {
				"AvailabilityZone" : "ap-south-1a",
				"ImageId" : "ami-04893cdb768d0f9ee",
				"InstanceType" : "t2.micro",
				"KeyName" : "vishesh",
				"SecurityGroupIds" : [
						"SourceSG"
					]
			}
        },
		"CreateVolume": {
			"Type": "AWS::EC2::Volume",
			"Properties": {
				"AvailabilityZone" : "ap-south-1a",
				"Encrypted" : false,
				"Size" : 1,
				"VolumeType" : "gp2"
			}
		},
		"AttachVolume": {
			"Type" : "AWS::EC2::VolumeAttachment",
			"DependsOn" : [ 
				"CreateInstance",
				"CreateVolume"
			],
			"Properties" : {
			  "Device" : "/dev/sdh",
			  "InstanceId" : { "Ref" : "CreateInstance" },
			  "VolumeId" : { "Ref" : "CreateVolume" }
			}
		}
	}
}